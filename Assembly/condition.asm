global _start

section .text
_start:
	
	jmp main

main:
	
	mov rax,0
	mov rdi,0
	mov rsi,input
	mov rdx,64
	syscall
	

cmp_key:
	cmp rax,keylen
	jne access_denied
	

	mov rsi,key
	mov rdi,input
	mov rcx,keylen
	repe cmpsb
	je access_granted
	jne access_denied



access_granted:
	mov rax,1
	mov rdi,1
	mov rsi,accgr
	mov rdx,accgrlen
	syscall
	jmp exit

access_denied:
	mov rax,1
	mov rdi,1
	mov rsi,accde
	mov rdx,accdelen	
	syscall

exit:
	
	mov rax,60
	mov rdi,11
	syscall




section .data

	key: db '123',10
	keylen: equ $-key
	
	accgr: db 'acced granted!',	10
	accgrlen: equ $-accgr


	accde: db 'acced denied!',	10
	accdelen: equ $-accde


section .bss
	
	input: resb 64

